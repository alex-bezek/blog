<!DOCTYPE html>
<html>
  <head>
    <title>Rails Environment VS Deploy Environment</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="/assets/css/layouts/main.css" />
<link rel="stylesheet" href="/assets/css/style.css" />
<link rel="stylesheet" href="/assets/css/navigators/navbar.css" />


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />


<link rel="icon" type="image/png" href="https://alexbezek.io/images/logo/logo-transparent.png" />


<link rel="stylesheet" href="/assets/css/style.css" />

    
<meta name="description" content="Understanding Rails environment settings vs real deployment environments" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/assets/css/layouts/single.css" />
<link rel="stylesheet" href="/assets/css/navigators/sidebar.css">


    
    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135069512-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    


  


  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      <img src="https://alexbezek.io/images/logo/logo-transparent.png">Alex Bezek&#39;s Blog</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  <img src="https://alexbezek.io/images/logo/logo-transparent.png" class="d-none" id="main-logo">
  <img src="https://alexbezek.io/images/logo/logo-transparent.png" class="d-none" id="inverted-logo">
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <input type="text" value="" placeholder="Search" data-search="" id="search-box" />
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="https://alexbezek.ioposts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/linking-to-local-images-in-gatsby-frontmatter/">Gatsby Frontmatter Local Images</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react-jsx/">Jsx vs JS</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/mssql-server-linux-docker-errors/">Microsoft SQL Server Linux Docker Errors</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/rails-environment-vs-deploy-environment/">Rails Environment VS Deploy Environment</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://alexbezek.io/images/posts/rails-environment-vs-deploy-environment/rails.png);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/assets/images/default-avatar.png'/>
          <h5 class="author-name"></h5>
          <p>May 9, 2019</p>
        </div>

        <div class="title">
          <h1>Rails Environment VS Deploy Environment</h1>
        </div>

        <div class="post-content" id="post-content">
          <p>When the same verbiage is used in multiple contexts, it can be uber confusing for new people. On my team, I recall over the years that the majority of people getting started with us get caught up briefly on the difference between the Rails Environments concept, vs our concept of deploying to multiple environments (like dev, staging, prod, etc).</p>
<p>For people brand new to the industry, the idea of multiple deployment environments may be the new part. The idea is fairly simple (and hopefully fairly common for cloud based software at least). If you have your code deployed somewhere that your clients/users utilize as the live environment, you need at least a secondary environment to deploy and test code before it releases. People often coin these as Dev and Prod. They should be as similar as possible. The code should execute the same, and if possible, the infrastructure should be the same.</p>
<p>Rails also has a concept of Environments, however, they mean something completely different. Out of the box, rails comes with 3 environments: Development, Test, and Production. With a new rails app, there is a file under <code>config/environments/*.rb</code> that correlates to the environment its named after. In each one, it contains specific code and settings that affect how rails works.</p>
<p>The confusing part for many, is that development.rb is NOT used when deployed to the dev environment (typically, and hopefully). Production.rb is used anytime its deployed. Like we said before, its ideal for code in the deployed dev and prod environments to run as similarly as possible.</p>
<p>The rails development environment is actually used for running locally, while production is used for anytime deploying. While it would be ideal to run your code locally and develop in an environment as similar as possible to how you run in production, in practice, this hinders your local dev speed quite a bit.</p>
<p>Specifically, when developing locally, running rails in development mode has a few advantages. Some of the ones you would notice almost immediately lacking if you tried developing in production mode area</p>
<ul>
<li>automatically reloading code in the app folder when edited.</li>
<li>compiling assets on the fly when edited instead of building a single static bundle.</li>
<li>error screens with stack traces and details about the error.</li>
</ul>
<p>The other primary environment rails comes with configured is the test environment. This is used when running unit tests like rspec or mini test. These files all come with pre-set configurations and can also be added to with more config, or actual code to customize them more.</p>
<h4 id="so-what-led-to-confusion">So what led to confusion?</h4>
<p>Often times, this problem comes up because the engineer has a task to make some functionality different between each environment (maybe call a different downstream endpoint or something). And so its a pretty clear first choice to turn to the development production config files glaring one in the face.</p>
<p>So how would you go about flexing some minor config per deployment environment? Well one way would be to actually setup a new environment type for each deployable environment via <a href="https://guides.rubyonrails.org/configuring.html#creating-rails-environments">https://guides.rubyonrails.org/configuring.html#creating-rails-environments</a> . The config could be a clone (or re-use the production config to keep things consistent) of the production config, with minor tweaks per new environment.</p>
<p>This would work fine for a shop with maybe just a dev and prod environment. However, if you start to expand, and have numerous environments you deploy to, this starts to break down. For example, at our company we have a dev, staging, and production. But we also have a production in 4 different global regions. And then in most global regions, we deploy to multiple zones (different cloud providers). Each one requires different config in order to set up the app or service to communicate with the infrastructure and other services in that deployment zone.</p>
<p>In order to flex config for any environment without having to make code changes, and release a new artifact, its advisable to follow the <a href="https://12factor.net/">12 factor app</a> pattern. With Rails, this means, you always run in production mode everywhere, and you utilize environment variables to flex key configuration in each deployment region.</p>

        </div>

        
        
          <div class="btn-improve-page">
              <a href="https://github.com/alex-bezek/blog/edit/master/content/posts/rails-environment-vs-deploy-environment.md">
                <i class="fas fa-code-branch"></i>
                Improve This Page
              </a>
          </div>
        

        
      <hr />
        <div class="row next-prev-navigator">


  

  

  

  
    
    
      
        
        
        <div class="col-md-12 next-article">
          <a href="/posts/react-jsx/" class="btn btn-outline-info">
            <span>Next <i class="fas fa-chevron-circle-right"></i></span>
            <br />
            <span>Jsx vs Js</span>
          </a>
        </div>
      
    
  

</div>

      <hr />
      
      
          <div id="disqus_thread"></div>
<script type="text/javascript">
  (function () {
    
    
    if (window.location.hostname == "localhost") return;

    var dsq = document.createElement("script");
    dsq.type = "text/javascript";
    dsq.async = true;
    var disqus_shortname = "alexbezek";
    dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (
      document.getElementsByTagName("head")[0] ||
      document.getElementsByTagName("body")[0]
    ).appendChild(dsq);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>
<a href="https://disqus.com/" class="dsq-brlink"
  >comments powered by <span class="logo-disqus">Disqus</span></a
>

      
      </div>
    </div>
  </div>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    

  




  




  
  
    
  


<footer class="container-fluid text-center align-content-center footer pb-2">
  <div class="container pt-5">
    <div class="row text-left">
      <div class="col-md-4 col-sm-12">
        <h5>Navigation</h5>
        
        <ul>
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#recent-posts">Recent Posts</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#about">About</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#experiences">Experiences</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#skills">Skills</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#projects">Projects</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#achievements">Achievements</a>
              </li>
            
        </ul>
        

      </div>
      
      <div class="col-md-4 col-sm-12">
        <h5>Contact me:</h5>
        <ul>
          
          <li><span>Email: </span> <span>alex.liam.bezek@gmail.com</span></li>
          
          <li><span>Phone: </span> <span>913-626-1909</span></li>
          
        </ul>
      </div>
      
      
    </div>
  </div>
  <hr />
  <div class="container">
    <div class="row text-left">
      <div class="col-md-4">
        <a id="theme" href="https://github.com/hossainemruz/toha" target="#">
          <img src="/assets/images/inverted-logo.png">
          Toha
        </a>
      </div>
      <div class="col-md-4 text-center">© 2020 Copyright.</div>
      <div class="col-md-4 text-right">
        <a id="hugo" href="https://gohugo.io/">Powered by
        <img
          src="/assets/images/hugo-logo-wide.svg"
          alt="Hugo Logo"
          height="18"
        />
        </a>
      </div>
    </div>
  </div>
</footer>

    <script src="/assets/js/jquery-3.4.1.min.js"></script>
<script src="/assets/js/popper.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>

<script src="/assets/js/navbar.js"></script>
<script src="/assets/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/assets/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
