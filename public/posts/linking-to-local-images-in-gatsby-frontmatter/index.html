<!DOCTYPE html>
<html>
  <head>
    <title>Linking to local images in Gatsby frontmatter</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
<link rel="stylesheet" href="/assets/css/layouts/main.css" />
<link rel="stylesheet" href="/assets/css/style.css" />
<link rel="stylesheet" href="/assets/css/navigators/navbar.css" />


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />


<link rel="icon" type="image/png" href="https://alexbezek.io/images/logo/logo-transparent.png" />


<link rel="stylesheet" href="/assets/css/style.css" />

    
<meta name="description" content="Debugging how to link to local images using Gatsby&#39;s frontmatter system" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/assets/css/layouts/single.css" />
<link rel="stylesheet" href="/assets/css/navigators/sidebar.css">


    
    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135069512-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    


  


  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      <img src="https://alexbezek.io/images/logo/logo-transparent.png">Alex Bezek&#39;s Blog</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  <img src="https://alexbezek.io/images/logo/logo-transparent.png" class="d-none" id="main-logo">
  <img src="https://alexbezek.io/images/logo/logo-transparent.png" class="d-none" id="inverted-logo">
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <input type="text" value="" placeholder="Search" data-search="" id="search-box" />
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="https://alexbezek.ioposts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/linking-to-local-images-in-gatsby-frontmatter/">Gatsby Frontmatter Local Images</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react-jsx/">Jsx vs JS</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/mssql-server-linux-docker-errors/">Microsoft SQL Server Linux Docker Errors</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/rails-environment-vs-deploy-environment/">Rails Environment VS Deploy Environment</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://alexbezek.io/images/posts/linking-to-local-images-in-gatsby-frontmatter/gatsby-site-data.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/assets/images/default-avatar.png'/>
          <h5 class="author-name"></h5>
          <p>October 8, 2017</p>
        </div>

        <div class="title">
          <h1>Linking to local images in Gatsby frontmatter</h1>
        </div>

        <div class="post-content" id="post-content">
          <p>Being stuck on an issue in a technology or concept you are brand new to can be paralyzing. You hardly know enough to figure out how to google the issue. Even if you do have a good search, the answer could be sitting right in front of your face, and often times you don&rsquo;t even know it. If it’s not a critical blocking issue, you may try to push it off till later and progress with your work. For me though, its always a nagging issue in the back of my head. I will try to do other work, but the perfectionist in me keeps me coming back the problem day after day. Eventually with much persistence (and a lot of luck) the solution dawns on you. Regardless of if it was a crazy strange issue, or a simple misunderstanding of the tech, you get an immediate sense of accomplishment for solving the issue. I think its what drives us in our field. To solve problems and get that leveling up factor. Down the road, when you are much more familiar with the topic, its fun to retrospect on how silly it was you couldn&rsquo;t figure it out and how easy it would be to solve that issue now.</p>
<p>I&rsquo;ve started this brand-new blog using a relatively new framework called <a href="https://www.gatsbyjs.org/">Gatsby</a>. If you make any static react based apps (probably using create-react-app) and find yourself trying to dynamically create pages with sets of data, I highly recommend trying it out. Even if you just have a set of react pages created, it automatically can handle all of the fancy config for things like react-router, service workers, statically generating html files, and optimal asset loading. One of the primary ways of using it is to create a set of markdown files and use GraphQl to generate the data to create a blog post for each. If you are familiar with jekyll or other static site generators, it has similar functionality to where you can define a set of meta data for each post in your markdown&rsquo;s frontmatter to use in your blog post template.</p>
<p>So I followed the tutorials and docs, getting a basic site with a handful of template posts working. I setup a bunch of random ideas of future posts without any content, but filling out the frontmatter so I could work on the UI for the front page in a more realistic state for the future. In the process, I got a bunch of posts with frontmatter following the examples online much like this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">title</span>: <span style="color:#e6db74">&#34;Linking to local images in Gatsby frontmatter&#34;</span>
<span style="color:#66d9ef">image</span>: <span style="color:#e6db74">&#34;https://i.ytimg.com/vi/dmgcUbz8gq8/maxresdefault.jpg&#34;</span>
<span style="color:#66d9ef">date</span>: <span style="color:#e6db74">&#34;10/08/2017&#34;</span>
<span style="color:#66d9ef">category</span>: <span style="color:#e6db74">&#34;Gatsby&#34;</span>
<span style="color:#66d9ef">tags</span>:
  - GraphQl
  - Gatsby
</code></pre></div><p>Gatsby allows you to use GraphQl to query your markdown files for data, passing that data into react components to dynamically create pages. Using a copy paste query from the tutorials, i was able to get my pages loading and using the image url as my image source</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-GraphQl" data-lang="GraphQl"><span style="color:#66d9ef">query</span> <span style="color:#a6e22e">IndexQuery</span> {
    edges {
      node {
        fields {
          slug
        }
        frontmatter {
          title
          tags
          date
          image
        }
      }
    }
  }
}
</code></pre></div><p>Everything was running smoothly and working great! But Gatsby is all about performance and optimization. One area it has great support for is optimizing image loading. Via some plugins that use the <a href="https://github.com/lovell/sharp">sharp processing library</a> it can do some cool things like optimized caching techniques, support for creating the optimal size image for the screen resolution, and the <a href="https://css-tricks.com/the-blur-up-technique-for-loading-background-images/">blur up technique</a>. None of these works when pulling an image from a URL client side, so instead I need to download it, process it with Gatsby, and serve it myself. Sure thing! There are plenty of examples for that. So, I set off to take one of my posts and try this out, downloading the file locally, and changing the frontmatter to</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">title</span>: <span style="color:#e6db74">&#34;Linking to local images in Gatsby frontmatter&#34;</span>
<span style="color:#66d9ef">image</span>: <span style="color:#e6db74">&#34;./gatsby-site-data.jpg&#34;</span>
<span style="color:#66d9ef">date</span>: <span style="color:#e6db74">&#34;10/08/2017&#34;</span>
<span style="color:#66d9ef">category</span>: <span style="color:#e6db74">&#34;Gatsby&#34;</span>
<span style="color:#66d9ef">tags</span>:
  - GraphQl
  - Gatsby
</code></pre></div><p>Cool, no errors. I go back to my hot reloaded browser and see no image. Strange, lets inspect in my browser. My image source is just &ldquo;./gatsby-site-data.jpg&rdquo; without any sort of relative link to my server along with a nice 404 in my network tab. Ok, let’s go back online to some tutorial. With some research, I find that I must get the actual source to the file in my GraphQl using the sharp library&rsquo;s GraphQl. I so change my GraphQl to something like this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-GraphQl" data-lang="GraphQl"><span style="color:#66d9ef">query</span> <span style="color:#a6e22e">IndexQuery</span> {
  edges {
    node {
      fields {
        slug
      }
      frontmatter {
        title
        tags
        date
        image {
          childImageSharp {
            original {
              src
            }
          }
        }
      }
    }
  }
}
</code></pre></div><p>Save, reload, and Bam! Error&hellip;.</p>
<pre><code>GraphQL Error Field &quot;image&quot; must not have a selection since type &quot;String&quot; has no subfields.
</code></pre><p>But&hellip; but&hellip; but&hellip; my image has subfields, it’s an image! This error is pretty clear in that the GraphQl expects a string, and as such, expects a primitive without any nested attributes like childImageSharp. At this point I spend about a week and a half looking through examples in the Gatsby repo <a href="https://github.com/gatsbyjs/gatsby/tree/master/examples">here</a> and looking through the linked example sites on their readme. I even message the discord channel trying to figure out what happened. No luck&hellip;</p>
<p>Eventually, I let it go. The images are still being pulled, it still looks fine, why block my work on this one little nagging thing. So, I keep going. I work on some styling and organization of my site, but this keeps bugging me. One day, I try moving all my files to the pages directory, and just to simplify things, I delete all my posts except the one I&rsquo;m trying to change the image source on. All of a sudden, I&rsquo;m not getting that error. After adding back in the extra GraphQL I&rsquo;m successfully loading the file from my local instead of from the url to the original source.</p>
<p>So, what happened?
&hellip;</p>
<p>Well truth be told, I&rsquo;m refactoring my blog and it turns out I failed to finish writing this. It seems I pulled this on myself&hellip;</p>
<figure>
    <img src="https://imgs.xkcd.com/comics/wisdom_of_the_ancients.png"/> 
</figure>


        </div>

        
        
          <div class="btn-improve-page">
              <a href="https://github.com/alex-bezek/blog/edit/master/content/posts/linking-to-local-images-in-gatsby-frontmatter.md">
                <i class="fas fa-code-branch"></i>
                Improve This Page
              </a>
          </div>
        

        
      <hr />
        <div class="row next-prev-navigator">


  
    
      
      <div class="col-md-6 previous-article">
        <a href="/posts/mssql-server-linux-docker-errors/" class="btn btn-outline-info">
          <span><i class="fas fa-chevron-circle-left"></i> Prev</span>
          <br />
          <span>Microsoft SQL Server Linux Docker Errors</span>
        </a>
      </div>
      
    
    
  

  

  

  

</div>

      <hr />
      
      
          <div id="disqus_thread"></div>
<script type="text/javascript">
  (function () {
    
    
    if (window.location.hostname == "localhost") return;

    var dsq = document.createElement("script");
    dsq.type = "text/javascript";
    dsq.async = true;
    var disqus_shortname = "alexbezek";
    dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (
      document.getElementsByTagName("head")[0] ||
      document.getElementsByTagName("body")[0]
    ).appendChild(dsq);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>
<a href="https://disqus.com/" class="dsq-brlink"
  >comments powered by <span class="logo-disqus">Disqus</span></a
>

      
      </div>
    </div>
  </div>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    

  




  




  
  
    
  


<footer class="container-fluid text-center align-content-center footer pb-2">
  <div class="container pt-5">
    <div class="row text-left">
      <div class="col-md-4 col-sm-12">
        <h5>Navigation</h5>
        
        <ul>
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#recent-posts">Recent Posts</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#about">About</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#experiences">Experiences</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#skills">Skills</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#projects">Projects</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#achievements">Achievements</a>
              </li>
            
        </ul>
        

      </div>
      
      <div class="col-md-4 col-sm-12">
        <h5>Contact me:</h5>
        <ul>
          
          <li><span>Email: </span> <span>alex.liam.bezek@gmail.com</span></li>
          
          <li><span>Phone: </span> <span>913-626-1909</span></li>
          
        </ul>
      </div>
      
      
    </div>
  </div>
  <hr />
  <div class="container">
    <div class="row text-left">
      <div class="col-md-4">
        <a id="theme" href="https://github.com/hossainemruz/toha" target="#">
          <img src="/assets/images/inverted-logo.png">
          Toha
        </a>
      </div>
      <div class="col-md-4 text-center">© 2020 Copyright.</div>
      <div class="col-md-4 text-right">
        <a id="hugo" href="https://gohugo.io/">Powered by
        <img
          src="/assets/images/hugo-logo-wide.svg"
          alt="Hugo Logo"
          height="18"
        />
        </a>
      </div>
    </div>
  </div>
</footer>

    <script src="/assets/js/jquery-3.4.1.min.js"></script>
<script src="/assets/js/popper.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>

<script src="/assets/js/navbar.js"></script>
<script src="/assets/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/assets/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
